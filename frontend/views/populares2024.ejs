<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="UTF-8" />
    <!-- BootStrap-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
      crossorigin="anonymous"
    ></script>

    <!-- Importando fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=WDXL+Lubrifont+SC&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <!-- CSS -->
    <link rel="stylesheet" href="../style/index.css" />
    <link rel="shortcut icon" href="../img/capacompleta.jpeg" />

    <!-- Título -->
    <title>Leitor Crítico - Os Mais Populares em 2024</title>
  </head>

  <body>
    <!-- TopBar -->
    <div class="top-bar">
      <span class="nome-da-plataforma">LEITOR CRÍTICO</span>
      <!-- Menu hamburger -->
      <div class="menu-hamburger" id="menuHamburger">
        <input type="checkbox" id="menu-toggle" hidden />
        <label for="menu-toggle" class="menu-icon">
          <div class="linha"></div>
          <div class="linha"></div>
          <div class="linha"></div>
        </label>
        <div class="overlay">
          <nav class="menu">
            <div class="user-profile">
              <a
                href="/dashboardCritico"
                class="user-link"
                title="Ir para o perfil"
              >
                <i class="fas fa-user-circle user-icon"></i>
                <span id="nomeUsuario"><%= usuario ? usuario.nome : "Visitante" %></span>
              </a>
            </div>
            <li>
              <a href="/">Início</a>
            </li>
            <li>
              <a href="/populares">Populares</a>
            </li>
            <li>
              <a href="/classicosdaliteraturabrasileira"
                >Clássicos da Literatura Brasileira</a
              >
            </li>
            <li>
              <a href="/popularesem2024">Os Mais Populares em 2024</a>
            </li>
            <li>
              <a
                style="background-color: transparent !important"
                class="nav-link active"
                aria-current="page"
                href="/login"
                id="login-cadastro-hamburger"
                >Login/Cadastro</a
              >
              <a
                style="
                  background-color: transparent !important;
                  margin-bottom: 15px;
                "
                href=""
                id="logout-hamburger"
                class="logoutCadastro"
                >Logout</a
              >
            </li>
          </nav>
        </div>
      </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/">Início</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/populares"
                >Populares</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="/classicosdaliteraturabrasileira"
                >Clássicos da Literatura Brasileira</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="/popularesem2024"
                >Os Mais Populares em 2024</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="/login"
                id="login-cadastro"
                >Login/Cadastro</a
              >
              <a href="" id="logout" class="logoutCadastro">Logout</a>
            </li>
          </ul>
        </div>
        <div class="user-profile">
          <a
            href="/dashboardCritico"
            class="user-link"
            title="Ir para o perfil"
          >
            <i class="fas fa-user-circle user-icon"></i>
            <span id="nomeUsuario">
              <% if (usuario) { %>
                <%= usuario.nome %>
                (<%= usuario.cargo.charAt(0).toUpperCase() + usuario.cargo.slice(1) %>)
              <% } else { %>
                Visitante
              <% } %>
            </span>
          </a>
        </div>
      </div>
    </nav>

    <!-- Conteúdo -->
    <section id="home">
      <div id="containerPrincipal">
        <div id="todasAsImagens">
          <h2 id="melhoresAvaliados">OS MAIS POPULARES EM 2024</h2>

          <% livros.forEach((livro) => { %>
            <div class="imgContainer">
              <a href="/livros?id=<%= livro.id_livro %>">
                <img src="<%= livro.link_imagem %>" alt="<%= livro.titulo %>" class="img2024" />
              </a>
              <div class="nomeLivroEAutor">
                <a href="/livros?id=<%= livro.id_livro %>">
                  <h1 class="h1Livros"><%= livro.titulo %></h1>
                </a>
                <p class="nomeAutor"><%= livro.autor %></p>
              </div>
              <a href="/livros?id=<%= livro.id_livro %>">
                <div class="containerAvaliacaoDosCriticos">
                  <% 
                    let classCor = '';
                    let notaTexto = 'NR';
                    
                    if (livro.media_criticos != null) {
                      const media = parseFloat(livro.media_criticos);
                      notaTexto = media.toFixed(1);
                      
                      if (media >= 70) {
                        classCor = 'verde';
                      } else if (media >= 50) {
                        classCor = 'amarelo';
                      } else {
                        classCor = 'vermelho';
                      }
                    }
                  %>
                  <span class="notaCriticaContainer <%= classCor %>"><%= notaTexto %></span>
                  <span class="avaliacaoCriticos">(avaliação dos críticos)</span>
                </div>
              </a>
            </div>
          <% }); %>
        </div>

        <!-- Paginação -->
        <div class="paginacao">
          <% if (paginaAtual > 1) { %>
            <a href="/popularesem2024?pagina=<%= paginaAtual - 1 %>" class="btn-paginacao">← Anterior</a>
          <% } %>
          
          <span class="info-paginacao">
            Página <%= paginaAtual %> de <%= totalPaginas %>
          </span>
          
          <% if (paginaAtual < totalPaginas) { %>
            <a href="/popularesem2024?pagina=<%= paginaAtual + 1 %>" class="btn-paginacao">Próxima →</a>
          <% } %>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="container">
        <p>&copy; 2025 Leitor Crítico</p>
      </div>
    </footer>

    <script src="../js/populares2024.js"></script>
    <script src="../js/comments.js"></script>
    <script src="../js/criticoControl.js"></script>
    <script src="../js/loginLogoutHamb.js"></script>
  </body>
</html>
